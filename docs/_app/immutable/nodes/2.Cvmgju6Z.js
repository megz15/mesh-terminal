import{b as I,c as G,f as Q,a as U}from"../chunks/B8lfIcJ7.js";import"../chunks/DPU5IEas.js";import{o as Y}from"../chunks/ChHpGbdi.js";import{t as Z,h as O,a as R,O as z,P as X,i as C,L as ee,Q as ae,R as se,s as te,M as $,j as re,l as le,T as g,D as v,G as D,$ as ne,m as _,u as S,n as b,V as N,o as j,q as T}from"../chunks/DypGfgoI.js";import{h as oe}from"../chunks/CXYaixbV.js";import{b as B}from"../chunks/HXamuLZn.js";import{i as ie}from"../chunks/CntupMq3.js";import{r as y,c as L,g as J,H as ue,p as ve,a as ce,b as pe,d as fe,t as me,e as de}from"../chunks/DiB3XbNj.js";import{g as ge}from"../chunks/DwD4BQrk.js";function x(w,M,t=!1,f=!1,H=!1){var h=w,c="";Z(()=>{var m=z;if(c===(c=M()??"")){O&&R();return}if(m.nodes_start!==null&&(X(m.nodes_start,m.nodes_end),m.nodes_start=m.nodes_end=null),c!==""){if(O){C.data;for(var n=R(),d=n;n!==null&&(n.nodeType!==8||n.data!=="");)d=n,n=ee(n);if(n===null)throw ae(),se;I(C,d),h=te(n);return}var p=c+"";t?p=`<svg>${p}</svg>`:f&&(p=`<math>${p}</math>`);var u=G(p);if((t||f)&&(u=$(u)),I($(u),u.lastChild),t||f)for(;$(u);)h.before($(u));else h.before(u)}})}var a=y(()=>ce),r=y(()=>de),l=y(()=>fe),e=y(()=>pe),K=y(()=>me),he=Q('<div class="input"><div id="outputHistory"><pre class="sm:break-all sm:whitespace-pre-wrap font-[Jetbrains_Mono]"><!></pre></div> <span id="prompt"><!></span> <span class="cmd-input sm:break-all text-gray-200"><!></span></div>');function Se(w,M){re(M,!1);let t=D(),f=D();Y(()=>{const s=localStorage.getItem("MESh_commandHistory");if(s)try{r(r().value=JSON.parse(s))}catch(o){console.error(o),r(r().value=[])}else r(r().value=[]);window.addEventListener("keydown",H)});function H(s){s.preventDefault(),h();const o=a().value.trim(),i=o.split(" ");if(s.key=="c"&&s.ctrlKey){g(t,v(t).innerHTML+=`<pre class="sm:break-all sm:whitespace-pre-wrap font-[Jetbrains_Mono]"> &gt&gt ${c("exit")}</pre>`),a(a().value=""),e(e().value=0);return}switch(s.key){case"Backspace":e().value>0&&(a(a().value=a().value.slice(0,e().value-1)+a().value.slice(e().value)),e(e().value--));break;case"Delete":e().value<a().value.length&&a(a().value=a().value.slice(0,e().value)+a().value.slice(e().value+1));break;case"Enter":const V=J();g(t,v(t).innerHTML+=`<pre class="text-gray-200 font-[Jetbrains_Mono]">${V} ${o}</pre>`),o&&(r().value.push(o),r().value.length>ue&&r().value.shift(),localStorage.setItem("MESh_commandHistory",JSON.stringify(r().value))),l(l().value=-1);const W=c(i[0],i.slice(1));i[0]!="clear"&&i[0]!=""&&i[0]!="cd"&&g(t,v(t).innerHTML+=`<pre class="sm:break-all sm:whitespace-pre-wrap font-[Jetbrains_Mono]"> &gt&gt ${W}</pre>`),a(a().value=""),e(e().value=0);break;case"ArrowLeft":e().value>0&&e(e().value--);break;case"ArrowRight":e().value<a().value.length&&e(e().value++);break;case"ArrowUp":r().value.length>0&&(l().value==-1?l(l().value=r().value.length-1):l().value>0&&l(l().value--),a(a().value=r().value[l().value]),e(e().value=a().value.length));break;case"ArrowDown":r().value.length>0&&l().value!==-1&&(l().value<r().value.length-1?(l(l().value++),a(a().value=r().value[l().value])):(l(l().value=-1),a(a().value="")),e(e().value=a().value.length));break;case"Home":e(e().value=0);break;case"End":e(e().value=a().value.length);break;case"Escape":a(a().value=""),e(e().value=0);break;case"Tab":if(i.length==1)if(o){const k=Object.keys(L).filter(F=>F.startsWith(o));k.length==1?(a(a().value=k[0]+" "),e(e().value=a().value.length)):k.length>1?g(t,v(t).innerHTML+=`<pre class="text-gray-400 font-[Jetbrains_Mono]">Suggestions: ${k.join(", ")}</pre>`):g(t,v(t).innerHTML+=`<pre class="text-gray-400 font-[Jetbrains_Mono]">No suggestions found for "${o}"</pre>`)}else g(t,v(t).innerHTML+=`<pre class="text-gray-400 font-[Jetbrains_Mono]">Type 'help' for a list of commands</pre>`);break;default:s.key.length==1&&(a(a().value=a().value.slice(0,e().value)+s.key+a().value.slice(e().value)),e(e().value++));break}}function h(){requestAnimationFrame(()=>{var s;(s=v(f))==null||s.scrollIntoView({behavior:"smooth",block:"end"})})}function c(s,o=[]){return s.startsWith("./")?ve.includes(s.slice(2))?(window.removeEventListener("keydown",H),K(K().value=!1),ge(s.slice(2)),`MESh: launching program <span class="text-yellow-400 font-semibold">${s.slice(2)}</span>`):`MESh: program not found: <span class="text-red-400 font-semibold">${s.slice(2)}</span>`:s in L?L[s].cmd(o):`MESh: command not found: <span class="text-red-400 font-semibold">${s}</span>`}function m(s,o){const i=Math.max(0,Math.min(o,s.length));return o==s.length?s+'<span class="bg-gray-300 text-black animate-[pulse_1s_ease_infinite]">&nbsp</span>':s.slice(0,i)+`<span class="bg-gray-300 text-black animate-[pulse_1s_ease_infinite]">${s[i]}</span>`+s.slice(i+1)}ie();var n=he();oe(s=>{ne.title="MESh - v0.0.1"});var d=_(n),p=_(d),u=_(p);x(u,()=>S(()=>c("banner"))),b(p),b(d),B(d,s=>N(t,s),()=>v(t));var E=j(d,2),P=_(E);x(P,()=>(T(J),S(J))),b(E);var A=j(E,2),q=_(A);x(q,()=>(T(a()),T(e()),S(()=>m(a().value,e().value)))),b(A),b(n),B(n,s=>N(f,s),()=>v(f)),U(w,n),le()}export{Se as component};
